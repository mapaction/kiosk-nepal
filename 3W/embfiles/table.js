function mv_showTableInFP(b){var d=!0,e=mv_getMediaScreen();"smartphone"==e&&(d=!1);mv_loadAttrTableFile(b,!0);if(0!=mv_XMLFileArray[b].count()){var f="Attribute von "+mv_XMLFileArray[b].Name;mv_closeTable(f);var c=mv_makeNode(document,"div",{id:"MVtableFP","class":"tableFP"});c.style.display="none";dojo.body().appendChild(c);var a=dojo.byId("MVtableContent");mv_removeEle(a);a=mv_makeNode(document,"div",{id:"MVtableContent"});c.appendChild(a);mv_sortTable(b);require(["dojox/layout/FloatingPane"],
function(a){a=new a({resizable:!1,dockable:!1,closable:d,"class":"tableFP",title:f,style:"position:absolute;top:30px;left:60px;width:auto;height:auto;visibility:hidden;padding-bottom:10px;z-index:4;"},"MVtableFP");a.startup();a.bringToTop();a.show();"smartphone"==e?a.maximize():a.set("style","width:auto;height:auto")})}}function mv_closeTable(b){var d=dijit.byId("MVtableFP");"undefined"!=typeof d&&d.title!=b&&d.destroy()}
function mv_sortTable(b,d,e,f){document.getElementById("MVtableContent").innerHTML="Bitte warten ...";try{try{var c=new ActiveXObject("Msxml2.XSLTemplate.4.0"),a=new ActiveXObject("Msxml2.FreeThreadedDOMDocument.4.0")}catch(h){c=new ActiveXObject("Msxml2.XSLTemplate"),a=new ActiveXObject("Msxml2.FreeThreadedDOMDocument")}a.async=!1;a.resolveExternals=!1;a.load("embfiles/styletable.xsl");c.stylesheet=a;var g=c.createProcessor();g.input=mv_XMLFileArray[b].XMLFile;g.addParameter("lid",b);d&&(g.addParameter("field",
"f"+(parseInt(d)-1)),g.addParameter("datatype",e),g.addParameter("orderby",f));g.transform();document.getElementById("MVtableContent").innerHTML=g.output}catch(k){c=new XSLTProcessor;a=mv_loadXMLDoc(mv_Doc.BaseURL+"/embfiles/styletable.xsl","xml");try{c.importStylesheet(a)}catch(l){a=document.implementation.createDocument("","",null),a.async=!1,a.load("embfiles/styletable.xsl"),c.importStylesheet(a)}c.setParameter(null,"lid",b);d&&(c.setParameter(null,"field","f"+(parseInt(d)-1)),c.setParameter(null,
"datatype",e),c.setParameter(null,"orderby",f));b=c.transformToFragment(mv_XMLFileArray[b].XMLFile,document);document.getElementById("MVtableContent").innerHTML="";document.getElementById("MVtableContent").appendChild(b)}}
function mv_tableToExcel(b,d){"string"==typeof b&&(b=document.getElementById(b));var e={worksheet:d||"Worksheet",table:b.innerHTML},f=function(a){return window.btoa(unescape(encodeURIComponent(a)))},c=function(a,b){return a.replace(/{(\w+)}/g,function(a,c){return b[c]})};window.navigator.msSaveOrOpenBlob?(e=["\ufeffdata:application/vnd.ms-excel;base64,"+c('<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>{table}</table></body></html>',
e)],blobObject=new Blob(e),window.navigator.msSaveOrOpenBlob(blobObject,d+".xls")):window.location.href="data:application/vnd.ms-excel;base64,"+f(c('<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>{table}</table></body></html>',
e))};